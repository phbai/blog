<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Ubuntu开启HTTPS和HTTP2 · phbai's blog</title><meta name="description" content="Ubuntu开启HTTPS和HTTP2 - Phbai"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://www.phbai.com/atom.xml" title="phbai's blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="data:image/png;base64,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" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="https://github.com/phbai" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Ubuntu开启HTTPS和HTTP2</h1><div class="post-info">2017年3月6日<a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-nginx-with-http-2-support-on-ubuntu-16-04" target="_blank" title="https://www.digitalocean.com/community/tutorials/how-to-set-up-nginx-with-http-2-support-on-ubuntu-16-04" class="post-from">翻译 · 原文地址</a></div><div class="post-content"><p>本文主要记录一下从无到开启HTTPS和HTTP2的过程。</p>
<a id="more"></a>
<h3 id="运行环境"><a href="#运行环境" class="headerlink" title="运行环境"></a>运行环境</h3><ul>
<li>Ubuntu 16.04 LTS</li>
<li>Nging 1.10.0</li>
<li>OpenSSL 1.0.2g</li>
</ul>
<h3 id="一、安装最新版本-Nginx"><a href="#一、安装最新版本-Nginx" class="headerlink" title="一、安装最新版本 Nginx"></a>一、安装最新版本 Nginx</h3><p><strong>首先更新下 apt-get</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get update</div></pre></td></tr></table></figure>
<p><strong>安装 nginx</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install nginx</div></pre></td></tr></table></figure>
<p>安装结束后，通过如下命令查看 Nginx 版本。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo nginx -v</div></pre></td></tr></table></figure>
<p>应该返回如下结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Ouput of sudo nginx -v</div><div class="line">nginx version: nginx/1.10.0 (Ubuntu)</div></pre></td></tr></table></figure>
<h3 id="二、更改-Nginx-监听端口并开启-HTTP2"><a href="#二、更改-Nginx-监听端口并开启-HTTP2" class="headerlink" title="二、更改 Nginx 监听端口并开启 HTTP2"></a>二、更改 Nginx 监听端口并开启 HTTP2</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vim /etc/nginx/sites-available/default</div></pre></td></tr></table></figure>
<p>找到下列几行。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">listen 80 default_server;</div><div class="line">listen [::]:80 default_server;</div></pre></td></tr></table></figure></p>
<p>更改为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">listen 443 ssl http2 default_server;</div><div class="line">listen [::]:443 ssl http2 default_server;</div></pre></td></tr></table></figure></p>
<h3 id="三、更改服务器名"><a href="#三、更改服务器名" class="headerlink" title="三、更改服务器名"></a>三、更改服务器名</h3><p>还是在default文件中，更改server_name<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">server_name example.com;</div></pre></td></tr></table></figure></p>
<p>到此这一步，可以通过如下命令测试Nginx服务配置是否正确。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo nginx -t</div></pre></td></tr></table></figure></p>
<p>如果你上述步骤都没有问题，应该得到如下的返回结果。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">nginx: the configuration file /etc/nginx/nginx.conf syntax is ok</div><div class="line">nginx: configuration file /etc/nginx/nginx.conf test is successful</div></pre></td></tr></table></figure></p>
<h3 id="四、添加SSL证书"><a href="#四、添加SSL证书" class="headerlink" title="四、添加SSL证书"></a>四、添加SSL证书</h3><p>因为HTTP2建议开启HTTPS，所以我们需要一个免费的HTTPS证书，这里推荐letsencrypt。<br>可通过如下命令安装 letsencrypt。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install letsencrypt</div></pre></td></tr></table></figure></p>
<p>安装完成后，执行如下指令生成SSL证书。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">letsencrypt certonly</div></pre></td></tr></table></figure></p>
<p>生成过程第一步是让你填写邮箱地址。<br>第二步是让你填写域名地址。填写格式为 example.com<br>证书生成完毕后，会得到如下结果。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Output:</div><div class="line">IMPORTANT NOTES:</div><div class="line"> - If you lose your account credentials, you can recover through</div><div class="line">   e-mails sent to sammy@digitalocean.com</div><div class="line"> - Congratulations! Your certificate and chain have been saved at</div><div class="line">   /etc/letsencrypt/live/example.com/fullchain.pem. Your</div><div class="line">   cert will expire on 2016-03-15. To obtain a new version of the</div><div class="line">   certificate in the future, simply run Let&apos;s Encrypt again.</div><div class="line"> - Your account credentials have been saved in your Let&apos;s Encrypt</div><div class="line">   configuration directory at /etc/letsencrypt. You should make a</div><div class="line">   secure backup of this folder now. This configuration directory will</div><div class="line">   also contain certificates and private keys obtained by Let&apos;s</div><div class="line">   Encrypt so making regular backups of this folder is ideal.</div><div class="line"> - If like Let&apos;s Encrypt, please consider supporting our work by:</div><div class="line"></div><div class="line">   Donating to ISRG / Let&apos;s Encrypt:   https://letsencrypt.org/donate</div><div class="line">   Donating to EFF:                    https://eff.org/donate-le</div></pre></td></tr></table></figure></p>
<p>证书保存路径为 /etc/letsencrypt/example.com/live/</p>
<p>再次编辑default<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vim /etc/nginx/sites-available/default</div></pre></td></tr></table></figure></p>
<p>添加如下SSL配置。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;</div><div class="line">ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;</div></pre></td></tr></table></figure></p>
<h3 id="五、为SSL连接提高加密安全系数"><a href="#五、为SSL连接提高加密安全系数" class="headerlink" title="五、为SSL连接提高加密安全系数"></a>五、为SSL连接提高加密安全系数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo openssl dhparam -out /etc/nginx/ssl/dhparam.pem 2048</div></pre></td></tr></table></figure>
<p>然后在 /etc/nginx/sites-available/default 加入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssl_dhparam  /etc/nginx/ssl/dhparam.pem;</div></pre></td></tr></table></figure></p>
<h3 id="六、重定向HTTP流量到HTTPS"><a href="#六、重定向HTTP流量到HTTPS" class="headerlink" title="六、重定向HTTP流量到HTTPS"></a>六、重定向HTTP流量到HTTPS</h3><p>在 default 下重开一个 server<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen 443 ssl http2 default_server;</div><div class="line">    listen [::]:443 ssl http2 default_server;</div><div class="line">    // other settings</div><div class="line">&#125;</div><div class="line">server &#123;</div><div class="line">       listen         80;</div><div class="line">       listen    [::]:80;</div><div class="line">       server_name    example.com;</div><div class="line">       return         301 https://$server_name$request_uri;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="七、重启-Nginx-服务"><a href="#七、重启-Nginx-服务" class="headerlink" title="七、重启 Nginx 服务"></a>七、重启 Nginx 服务</h3><p>至此，Nginx服务都配置完成了。你的配置应该如下所示。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">        listen 443 ssl http2 default_server;</div><div class="line">        listen [::]:443 ssl http2 default_server;</div><div class="line"></div><div class="line">        root /var/www/html;</div><div class="line"></div><div class="line">        index index.html index.htm index.nginx-debian.html;</div><div class="line"></div><div class="line">        server_name example.com;</div><div class="line"></div><div class="line">        location / &#123;</div><div class="line">                try_files $uri $uri/ =404;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        ssl_certificate /etc/nginx/ssl/example.com.crt;</div><div class="line">        ssl_certificate_key /etc/nginx/ssl/example.com.key;</div><div class="line">        ssl_dhparam /etc/nginx/ssl/dhparam.pem;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">server &#123;</div><div class="line">       listen         80;</div><div class="line">       listen    [::]:80;</div><div class="line">       server_name    example.com;</div><div class="line">       return         301 https://$server_name$request_uri;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>为了保存至此的修改，重启Nginx服务。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo service nginx restart</div></pre></td></tr></table></figure></p>
<h3 id="八、大功告成"><a href="#八、大功告成" class="headerlink" title="八、大功告成"></a>八、大功告成</h3><p>你的服务器已经开启了HTTP2和HTTPS，那么怎么检查网站是否开启HTTP2协议呢。<br>打开Chrome开发工具，右键表头开启协议显示如下图所示。<br><img src="https://assets.digitalocean.com/articles/nginx_http2/http2_check.png" alt="开启协议显示"><br>现在我们看到，所有的请求都是HTTP2请求。</p>
</div></article></div></main><footer><div class="paginator"><a href="/2017/01/07/博客所用技术/" class="next">下一篇</a></div><div class="copyright"><p>© 2016 - 2017 <a href="http://www.phbai.com">Phbai</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>